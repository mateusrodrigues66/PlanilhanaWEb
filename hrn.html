<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="css/hrn.css">
<link rel="icon" href="/image003.png" type="image/x-icon">
<title>APR - Análise e Apreciação de Risco</title>
</head>
<body>
    <div class="wrapper">
        <button id="btnAddImages" class="btn-style">Inserir Imagens</button>

        <input type="file" id="imageInput" multiple style="display: none;" />
        <div class="scroll-wrapper">
        <table class="sticky-header">
          <thead>
            <tr class="sticky-header">
              <th colspan="8" style="background-color: #DAA520;">IDENTIFICAÇÃO</th>
              <th colspan="13" style="background-color: #32CD32;">SISTEMAS DE SEGURANÇA</th>
              <th colspan="6" style="background-color: #6495ED;">IDENTIFICAÇÃO DE PERIGOS / RISCOS ISO 12.100</th>
              <th colspan="10" style="background-color: #FF69B4;">AVALIAÇÃO DE RISCO HRN</th>
              <th colspan="4" style="background-color: #1E90FF;">AVALIAÇÃO DE CATEGORIA DE RISCO NBR 14.153</th>
              <th style="background-color: #FF6347;">AÇÕES RECOMENDADAS</th>
            </tr>
            <tr>
              <th>ITEM</th>
              <th>TAG</th>
              <th>MÁQUINA OU EQUIPAMENTO</th>
              <th>MARCA</th>
              <th>TIPO</th>
              <th>DESCRITIVO</th>
              <th>SETOR</th>
              <th>CAPACIDADE OPERACIONAL</th>
              <th>Relê de Seg</th>
              <th>CLP de Seg</th>
              <th>Sensor Eletrom.</th>
              <th>Disp. Mec. Tunel</th>
              <th>Intertravamento</th>
              <th>Aterramento</th>
              <th>Manual da Máq.</th>
              <th>Valv. Seg. Pneum.</th>
              <th>Valv. Seg. Hidrául.</th>
              <th>Bloco de Seg.</th>
              <th>Chave Seccionad.</th>
              <th>Botão de Emerg.</th>
              <th>Plaqueta NR 12</th>
              <th>IMAGEM</th>
              <th>ITEM AVALIADO</th>
              <th>PERIGO</th>
              <th>ORIGEM</th>
              <th>CONSEQUÊNCIAS</th>
              <th>TIPO DE RISCO</th>
              <th>PROBABILIDADE DE OCORRÊNCIA</th>
              <th>PO</th>
              <th>FREQUÊNCIA DE EXPOSIÇÃO</th>
              <th>FE</th>
              <th>GRAU DE POSSÍVEL LESÃO</th>
              <th>GPL</th>
              <th>Nº DE PES. EXPOSTAS</th>
              <th>NP</th>
              <th>HRN</th>
              <th>CLASSIFICAÇÃO DO RISCO</th>
              <th>SEV</th>
              <th>FREQ</th>
              <th>POS</th>
              <th>CAT REQUERIDA</th>
              <th>AÇÕES PARA ADEQUAÇÃO, REDUÇÃO OU ELIMINAÇÃO DO RISCO</th>
            </tr>
    </thead>
    <tbody>
    </tbody>
  </table>
</div>
</div>
<button id="btnBack" class="btn-style">Voltar</button>
<div id="imagemModal" style="display:none; position:fixed; z-index:1000; left:0; top:0; width:100%; height:100%; background-color:rgba(0,0,0,0.5); text-align:center;">
  <span id="fecharModal" style="position:absolute; top:10px; right:25px; color:white; font-size:30px; cursor:pointer;">&times;</span>
  <img id="imagemModalContent" style="max-width:80%; max-height:80%; margin-top:50px;">
</div>
<script>
  document.getElementById('btnAddImages').addEventListener('click', function() {
      document.getElementById('imageInput').click();
  });
  
  document.getElementById('btnBack').addEventListener('click', function() {
      window.location.href = 'index.html';
  });
  
  document.getElementById('imageInput').addEventListener('change', function(event) {
    const files = event.target.files;
    const tableBody = document.querySelector('table tbody');

    for (const file of files) {
        const reader = new FileReader();
        reader.onload = function(e) {
            const itemNumber = tableBody.rows.length + 1;
            const newRow = tableBody.insertRow();
            newRow.insertCell(0).textContent = itemNumber; 

            for (let i = 1; i < 8; i++) {
                const editableCell = newRow.insertCell(i);
                editableCell.contentEditable = 'true';
                editableCell.innerHTML = '&nbsp;'; 
            }
            const options = ['N.A', 'SIM', 'NÃO'];
            for (let i = 8; i <= 20; i++) {
                const selectCell = newRow.insertCell(i);
                const select = document.createElement('select');
                options.forEach(option => {
                    const optionElement = document.createElement('option');
                    optionElement.value = option;
                    optionElement.textContent = option;
                    select.appendChild(optionElement);
                });
                selectCell.appendChild(select);
            }
            const imgCell = newRow.insertCell(21);
            const image = document.createElement('img');
            image.src = e.target.result;
            image.alt = 'Imagem';
            image.style = 'height: 1.8cm; width: 4cm; cursor: pointer;';
            imgCell.appendChild(image);

            image.onclick = function() {
                document.getElementById('imagemModal').style.display = 'block';
                document.getElementById('imagemModalContent').src = this.src;
            };
            for (let i = 22; i < 42; i++) {
                newRow.insertCell(i).innerHTML = '&nbsp;';
            }
        };
        reader.readAsDataURL(file);
    }
});

  
  document.getElementById('fecharModal').onclick = function() {
      document.getElementById('imagemModal').style.display = 'none';
  };


window.addEventListener('scroll', function() {
  const offset = window.scrollY;
  const tableHeader = document.querySelector('.sticky-header th');
  if (offset > tableHeader.offsetTop) {
    tableHeader.classList.add('sticky');
  } else {
    tableHeader.classList.remove('sticky');
  }
});
  </script>
  
</body>
</html>
